name: CI/CD Pipeline

# 触发条件：当有人向 main 分支 push（推送）代码时执行
on:
  push:
    branches: [ main ]

jobs:
  # 任务 1：检查语法错误
  check-code:
    runs-on: ubuntu-latest
    steps:
      - name: 检查代码
        uses: actions/checkout@v4 # 把你的代码拉取到虚拟机里

      - name: 安装 Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: 安装依赖
        run: npm install

      - name: 运行语法检查 (Lint)
        run: npm run lint # 这里的命令取决于你 package.json 里的脚本

  # 任务 2：自动部署到 GitHub Pages
  deploy:
    needs: check-code # 只有通过了语法检查，才会执行部署
    runs-on: ubuntu-latest
    steps:
      - name: 检查代码
        uses: actions/checkout@v4

      - name: 打包项目
        run: |
          npm install
          npm run build # 生成可以直接上线的静态文件（通常在 dist 文件夹）

      - name: 部署到 GitHub Pages
        uses: peaceiris/actions-gh-pages@v3 # 这是一个常用的开源部署动作
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist # 告诉 GitHub 把哪个文件夹的内容变成网页
